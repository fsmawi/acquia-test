<table class="full-width">
  <thead>
  <tr>
    <th class="center">Status</th>
    <th class="center">Job</th>
    <th class="center">Branch</th>
    <th class="hidden-xs-down center">Commit</th>
    <th class="hidden-sm-down center">Duration</th>
    <th class="hidden-sm-down center">Completed</th>
    <th class="hidden-xs-down center">Actions</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let job of jobs">
    <td class="center">
      <app-job-status mdTooltip="{{job.message }}"
                      mdTooltipPosition="right"
                      [status]="job.status"></app-job-status>
    </td>
    <td class="center">
      <a appSegmentOn="click"
         [segmentEventData]="{appId: appId, job_id: job.job_id, status: job.status}"
         segmentEventIdentifier="ClickJobListDetailLink"
         appLiftOn="click"
         [liftEventData]="{appId: appId}"
         liftEventName="ClickJobListDetailLink"
         [appContextLink]="[{text: 'Open in new Tab', link: cloudUrl+'/'+job.job_id, target: '_blank' }]"
         appIframeLink="/applications/{{appId}}/{{job.job_id}}">{{job.job_id | slice:0:8}}</a>
    </td>
    <td class="center">
      <a *ngIf="job.metadata?.pull_request_link"
         href="{{job.metadata.pull_request_link}}" target="_blank"
         appLiftOn="click"
         [liftEventData]="{appId: appId}"
         liftEventName="ClickPullRequestLinkJobList"
         appSegmentOn="click"
         [segmentEventData]="{appId: appId, job_id: job.job_id, status: job.status}"
         segmentEventIdentifier="ClickPullRequestLinkJobList">
        PR {{job.metadata.pull_request}}
      </a>
      <span *ngIf="!job.metadata?.pull_request_link">
        {{job.metadata?.pull_request ? ('PR ' + job.metadata.pull_request) : (job.branch || 'None')}}
      </span>
    </td>
    <td class="hidden-xs-down center">
      <a *ngIf="job.metadata?.commit_link" href="{{job.metadata.commit_link}}" target="_blank">
        {{job.metadata.git_sha | slice:0:8}}
      </a>
      {{job.metadata?.commit_link ? '' : job.metadata?.git_sha ? (job.metadata.git_sha | slice:0:8) : 'None'}}
    </td>
    <td class="center hidden-sm-down" *ngIf="job.duration">{{job.duration | amDuration:'seconds'}}</td>
    <td class="center hidden-sm-down" *ngIf="!job.duration">-</td>
    <td class="center hidden-sm-down" *ngIf="job.finished_at">{{(job.finished_at | amFromUnix) | amTimeAgo }}</td>
    <td class="center hidden-sm-down" *ngIf="!job.finished_at">-</td>
    <td class="center hidden-xs-down">
      <!-- TODO Refresh is not available in the API yet -->
      <!-- <button md-button *ngIf="job.isFailed" (click)="restartJob(job)"> -->
      <!-- <md-icon color="primary">refresh</md-icon> -->
      <!-- </button> -->

      <a *ngIf="job.isFinished && job.metadata && job.metadata.deployment_link"
         href="{{job.metadata.deployment_link}}" target="_blank">
        <e-svg-icon class="primary" type="alpha__globe"
                    *ngIf="job.isFinished && job.metadata && job.metadata.deployment_link"
                    mdTooltip="Open Environment"
                    style="cursor:pointer"
                    mdTooltipPosition="left">
        </e-svg-icon>
      </a>

      <e-svg-icon class="danger" type="actions__close--circle"
                  *ngIf="job.isUnfinished" (click)="stopJob(job)"
                  mdTooltip="Terminate Job"
                  style="cursor:pointer"
                  mdTooltipPosition="left">
      </e-svg-icon>
    </td>
  </tr>
  </tbody>
</table>
